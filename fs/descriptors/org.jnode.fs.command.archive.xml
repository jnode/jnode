<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plugin SYSTEM "jnode.dtd">

<plugin id="org.jnode.fs.command.archive"
        name="JNode archive commands"
        version="@VERSION@"
        license-name="lgpl"
        provider-name="JNode.org">

  <requires>
    <import plugin="org.apache.tools.archive" />
    <import plugin="org.jnode.shell" />
  </requires>
  
  <runtime>
    <library name="jnode-fs.jar">
      <export name="org.jnode.fs.command.archive.*" />
      <export name="org.jnode.fs.command.AbstractDirectoryWalker" />
    </library>
  </runtime>
  
  <extension point="org.jnode.shell.aliases">
    <alias name="bzip2" class="org.jnode.fs.command.archive.BZipCommand" />
    <alias name="bunzip2" class="org.jnode.fs.command.archive.BUnzipCommand" />
    <alias name="bzcat" class="org.jnode.fs.command.archive.BZCatCommand" />
    <alias name="gzip" class="org.jnode.fs.command.archive.GZipCommand" />
    <alias name="gunzip" class="org.jnode.fs.command.archive.GUnzipCommand" />
    <alias name="tar" class="org.jnode.fs.command.archive.TarCommand" />
    <alias name="unzip" class="org.jnode.fs.command.archive.UnzipCommand" />
    <alias name="zcat" class="org.jnode.fs.command.archive.ZCatCommand" />
    <alias name="zip" class="org.jnode.fs.command.archive.ZipCommand" />
  </extension>
  
  <extension point="org.jnode.shell.syntaxes">
    <syntax alias="bunzip2">
      <empty description="decompress stdin to stdout" />
      <sequence description="decompress files">
        <optionSet>
          <!-- BZip -->
          <option argLabel="compress" shortName="z" longName="compress"/>
          <option argLabel="decompress" shortName="d" longName="decompress"/>
          <option argLabel="test" shortName="t" longName="test" />
          <option argLabel="keep" shortName="k" longName="keep" />
          <option argLabel="small" shortName="s" longName="small" />
          <!-- ArchiveCommand -->
          <option argLabel="stdout" shortName="c" longName="stdout" />
          <option argLabel="force" shortName="f" longName="force" />
          <option argLabel="verbose" shortName="v" longName="verbose" />
          <option argLabel="quiet" shortName="q" longName="quiet" />
          <option argLabel="debug" longName="debug" />
        </optionSet>
        <repeat>
          <argument argLabel="files" />
        </repeat>
      </sequence>
    </syntax>
    <syntax alias="bzcat">
      <empty description="decompress stdin to stdout" />
      <sequence description="decompress files to stdout">
        <optionSet>
          <option argLabel="small" shortName="s" longName="small" />
        </optionSet>
        <repeat>
          <argument argLabel="files" />
        </repeat>
      </sequence>
    </syntax>
    <syntax alias="bzip2">
      <empty description="compress stdin to stdout" />
      <sequence description="compress files">
        <optionSet>
          <!-- BZipCommand -->
          <option argLabel="c1" shortName="1" longName="fast" />
          <option argLabel="c2" shortName="2" />
          <option argLabel="c3" shortName="3" />
          <option argLabel="c4" shortName="4" />
          <option argLabel="c5" shortName="5" />
          <option argLabel="c6" shortName="6" />
          <option argLabel="c7" shortName="7" />
          <option argLabel="c8" shortName="8" />
          <option argLabel="c9" shortName="9" longName="best" />
          <!-- BZip -->
          <option argLabel="decompress" shortName="d" longName="decompress" />
          <option argLabel="compress" shortName="z" longName="compress" />
          <option argLabel="test" shortName="t" longName="test" />
          <option argLabel="keep" shortName="k" longName="keep" />
          <option argLabel="small" shortName="s" longName="small" />
          <!-- ArchiveCommand -->
          <option argLabel="stdout" shortName="c" longName="stdout" />
          <option argLabel="force" shortName="f" longName="force" />
          <option argLabel="verbose" shortName="v" longName="verbose" />
          <option argLabel="quiet" shortName="q" longName="quiet" />
          <option argLabel="debug" longName="debug" />
        </optionSet>
        <repeat>
          <argument argLabel="files" />
        </repeat>
      </sequence>
    </syntax>
    <syntax alias="gunzip">
      <empty description="decompress standard input to standard output" />
      <sequence description="decompress files">
        <optionSet>
          <!-- GZip -->
          <option argLabel="test" shortName="t" longName="test" />
          <option argLabel="list" shortName="l" longName="list" />
          <option argLabel="recurse" shortName="r" longName="recursive" />
          <option argLabel="noname" shortName="n" longName="no-name" />
          <option argLabel="name" shortName="N" longName="name" />
          <!-- ArchiveCommand -->
          <option argLabel="stdout" shortName="c" longName="stdout" />
          <option argLabel="force" shortName="f" longName="force" />
          <option argLabel="quiet" shortName="q" longName="quiet" />
          <option argLabel="verbose" shortName="v" longName="verbose" />
          <option argLabel="debug" longName="debug" />
        </optionSet>
        <optional eager="true"><option argLabel="suffix" shortName="S" longName="suffix" /></optional>
        <repeat minCount="1">
          <argument argLabel="files" />
        </repeat>
      </sequence>
    </syntax>
    <syntax alias="gzip">
      <empty description="compress standard input to standard output" />
      <sequence description="compress files">
        <optionSet>
          <!-- GZipCommand -->
          <option argLabel="c1" shortName="1" longName="fast" />
          <option argLabel="c9" shortName="9" longName="best" />
          <option argLabel="decompress" shortName="d" longName="decompress" />
          <!-- GZip -->
          <option argLabel="test" shortName="t" longName="test" />
          <option argLabel="list" shortName="l" longName="list" />
          <option argLabel="recurse" shortName="r" longName="recursive" />
          <option argLabel="noname" shortName="n" longName="no-name" />
          <option argLabel="name" shortName="N" longName="name" />
          <!-- ArchiveCommand -->
          <option argLabel="stdout" shortName="c" longName="stdout" />
          <option argLabel="force" shortName="f" longName="force" />
          <option argLabel="quiet" shortName="q" longName="quiet" />
          <option argLabel="verbose" shortName="v" longName="verbose" />
          <option argLabel="debug" longName="debug" />
        </optionSet>
        <optional eager="true"><option argLabel="suffix" shortName="S" longName="suffix" /></optional>
        <repeat minCount="1">
          <argument argLabel="files" />
        </repeat>
      </sequence>
    </syntax>
    <syntax alias="tar">
      <sequence>
        <optionSet description="tar options">
          <!-- Tar Operations -->
          <option argLabel="doAppend" shortName="r" longName="append" />
          <option argLabel="doCreate" shortName="c" longName="create" />
          <option argLabel="doConcat" shortName="A" longName="concatenate" />
          <option argLabel="doDelete" longName="delete" />
          <option argLabel="doDiff" shortName="d" longName="diff" />
          <option argLabel="doExtract" shortName="x" longName="extract" />
          <option argLabel="doList" shortName="t" longName="list" />
          <option argLabel="doUpdate" shortName="u" longName="update" />
          <!-- Tar Global Options -->
          <option argLabel="archive" shortName="f" longName="file" />
          <option argLabel="backup" longName="backup" />
          <option argLabel="bzip" shortName="j" longName="bzip2" />
          <option argLabel="fileList" shortName="T" longName="files-from"/>
          <option argLabel="gzip" shortName="z" longName="gzip" />
          <option argLabel="interact" shortName="w" longName="interactive" />
          <option argLabel="keep_old" shortName="k" longName="keep-old-files" />
          <option argLabel="keep_new" longName="keep-newer-files" />
          <option argLabel="removeFiles" longName="remove-files" />
          <option argLabel="showTotals" longName="totals" />
          <option argLabel="suffix" longName="suffix" />
          <option argLabel="unlink" longName="unlink" />
          <option argLabel="verify" shortName="W" longName="verify" />
          <option argLabel="xfile" shortName="X" longName="exclude-from"/>
          <!-- Tar Path Parser Options -->
          <option argLabel="exclude" longName="exclude" label="pattern" />
          <option argLabel="noRecurse" longName="no-recursion" />
          <option argLabel="recurse" longName="recursion" />
          <option argLabel="dir" shortName="C" longName="directory" />
          <!-- ArchiveCommand -->
          <option argLabel="verbose" shortName="v" longName="verbose" />
          <option argLabel="debug" longName="debug" />
          <option argLabel="stdout" shortName="O" longName="to-stdout" />
          <!--
          <option argLabel="minDate" shortName="N" longName="newer" />
          <option argLabel="minMTime" longName="newer-mtime" />
          -->
        </optionSet>
        <repeat>
          <argument argLabel="paths"/>
        </repeat>
      </sequence>
    </syntax>
    <syntax alias="unzip">
      <sequence>
        <optionSet>
          <!-- UnzipCommand -->
          <option argLabel="backup" shortName="B"/>
          <option argLabel="ignore-case" shortName="C"/>
          <option argLabel="keep" shortName="n"/>
          <option argLabel="overwrite" shortName="o"/>
          <!-- Zip -->
          <option argLabel="no-path" shortName="j"/>
          <!-- Zip Operations -->
          <option argLabel="freshen" shortName="f"/>
          <option argLabel="list" shortName="l"/>
          <option argLabel="test" shortName="t"/>
          <option argLabel="update" shortName="u"/>
          <!-- ArchiveCommand -->
          <option argLabel="stdout" shortName="p"/>
          <option argLabel="verbose" shortName="v"/>
          <option argLabel="quiet" shortName="q"/>
          <option argLabel="debug" longName="debug"/>
        </optionSet>
        <argument argLabel="archive"/>
        <repeat>
          <argument argLabel="patterns"/>
        </repeat>
        <!-- TODO
        <repeat>
          <option argLabel="exclude" shortName="x"/>
        </repeat>
        <optional>
          <option argLabel="extract-dir" shortName="d"/>
        </optional>
        -->
      </sequence>
    </syntax>
    <syntax alias="zcat">
      <empty description="decompress standard input to standard output" />
      <repeat minCount="1">
        <argument argLabel="files" />
      </repeat>
    </syntax>
    <syntax alias="zip">
      <sequence>
        <optionSet>
          <!-- ZipCommand -->
          <option argLabel="files-stdin" shortName="@"/>
          <option argLabel="tmp-dir" shortName="b"/>
          <option argLabel="no-dirs" shortName="D"/>
          <option argLabel="no-compress" shortName="n"/>
          <option argLabel="recurse" shortName="r"/>
          <!--<option argLabel="recurse-cd" shortName="R"/>-->
          <option argLabel="newer" shortName="t"/>
          <option argLabel="older" longName="tt"/> 
          <!-- Zip -->
          <option argLabel="no-path" shortName="j"/>
          <!-- Zip Operations -->
          <option argLabel="delete" shortName="d"/>
          <option argLabel="freshen" shortName="f"/>
          <option argLabel="move" shortName="m"/>
          <option argLabel="update" shortName="u"/>
          <!-- ArchiveCommand -->
          <option argLabel="quiet" shortName="q"/>
          <option argLabel="verbose" shortName="v"/>
          <option argLabel="debug" longName="debug"/>
        </optionSet>
        <argument argLabel="archive"/>
        <repeat>
          <alternatives>
            <option argLabel="exclude" shortName="x"/>
            <option argLabel="include" shortName="i"/>
            <argument argLabel="patterns"/>
          </alternatives>
        </repeat>
      </sequence>
    </syntax>
  </extension>
  
  <extension point="org.jnode.security.permissions">
    <permission class="java.io.FilePermission" name="&lt;&lt;ALL FILES&gt;&gt;" actions="read,write,delete"/>
    <permission class="java.util.PropertyPermission" name="user.dir" actions="read,write"/>
    <permission class="java.util.PropertyPermission" name="*" actions="read,write"/>
    <permission class="java.lang.RuntimePermission" name="modifyThreadGroup"/>
    <permission class="java.lang.RuntimePermission" name="exitVM"/>
    <permission class="org.jnode.security.JNodePermission" name="getVmClass"/>
  </extension>
</plugin>
